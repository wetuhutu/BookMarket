# 登录页面接口文档

## 1. 接口概述

### 1.1 基础信息
- **接口协议**：HTTPS
- **数据格式**：JSON
- **字符编码**：UTF-8
- **请求头**：
  - `Content-Type: application/json`
  - `Authorization: Bearer {token}`（需要认证的接口）

### 1.2 基础URL
- **开发环境**：`http://localhost:8080/api`
- **生产环境**：`https://api.bookmarket.com/api`

### 1.3 通用响应格式

#### 成功响应
```json
{
  "code": 200,
  "message": "success",
  "data": {}
}
```

#### 错误响应
```json
{
  "code": 400,
  "message": "错误信息",
  "data": null
}
```

### 1.4 错误码说明

| 错误码 | 说明 |
|-------|------|
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权，需要登录 |
| 403 | 禁止访问 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |
| 1001 | 用户名或密码错误 |
| 1002 | 用户已存在 |
| 1003 | 验证码错误 |
| 1004 | 验证码已过期 |

---

## 2. 登录相关接口

### 2.1 用户登录

**接口名称**：用户登录

**请求方法**：POST

**URL路径**：`/auth/login`

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|-------|------|------|------|
| account | String | 是 | 账号（手机号/邮箱/用户名） |
| password | String | 是 | 密码 |
| type | String | 否 | 登录类型（password/sms），默认password |

**请求示例**：
```json
{
  "account": "13800138000",
  "password": "123456",
  "type": "password"
}
```

**响应数据结构**：

| 字段名 | 类型 | 说明 |
|-------|------|------|
| token | String | 访问令牌 |
| user | Object | 用户信息 |

**用户信息结构**：

| 字段名 | 类型 | 说明 |
|-------|------|------|
| id | Number | 用户ID |
| username | String | 用户名 |
| phone | String | 手机号 |
| email | String | 邮箱 |
| avatar | String | 头像URL |
| level | String | 会员等级 |
| points | Number | 积分 |
| isSeller | Boolean | 是否卖家 |
| sellerInfo | Object | 卖家信息 |
| createdAt | String | 创建时间 |

**响应示例**：
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "张三",
      "phone": "13800138000",
      "email": "zhangsan@example.com",
      "avatar": "https://example.com/avatar.jpg",
      "level": "普通会员",
      "points": 2580,
      "isSeller": false,
      "sellerInfo": null,
      "createdAt": "2024-01-15T10:00:00Z"
    }
  }
}
```

---

### 2.2 用户注册

**接口名称**：用户注册

**请求方法**：POST

**URL路径**：`/auth/register`

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|-------|------|------|------|
| phone | String | 是 | 手机号 |
| code | String | 是 | 验证码 |
| username | String | 是 | 用户名（4-20个字符） |
| password | String | 是 | 密码（6-20个字符） |
| email | String | 否 | 邮箱 |

**请求示例**：
```json
{
  "phone": "13800138000",
  "code": "123456",
  "username": "张三",
  "password": "123456",
  "email": "zhangsan@example.com"
}
```

**响应数据结构**：

| 字段名 | 类型 | 说明 |
|-------|------|------|
| token | String | 访问令牌 |
| user | Object | 用户信息 |

**响应示例**：
```json
{
  "code": 200,
  "message": "注册成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "张三",
      "phone": "13800138000",
      "email": "zhangsan@example.com",
      "avatar": "https://example.com/avatar.jpg",
      "level": "普通会员",
      "points": 0,
      "createdAt": "2024-01-15T10:00:00Z"
    }
  }
}
```

---

### 2.3 手机验证码登录

**接口名称**：手机验证码登录

**请求方法**：POST

**URL路径**：`/auth/sms-login`

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|-------|------|------|------|
| phone | String | 是 | 手机号 |
| code | String | 是 | 验证码 |

**请求示例**：
```json
{
  "phone": "13800138000",
  "code": "123456"
}
```

**响应数据结构**：

| 字段名 | 类型 | 说明 |
|-------|------|------|
| token | String | 访问令牌 |
| user | Object | 用户信息 |

**响应示例**：
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "张三",
      "phone": "13800138000",
      "avatar": "https://example.com/avatar.jpg",
      "level": "普通会员",
      "points": 2580
    }
  }
}
```

---

### 2.4 发送验证码

**接口名称**：发送验证码

**请求方法**：POST

**URL路径**：`/auth/send-code`

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|-------|------|------|------|
| phone | String | 是 | 手机号 |
| type | String | 是 | 类型（register/login/reset） |

**请求示例**：
```json
{
  "phone": "13800138000",
  "type": "register"
}
```

**响应示例**：
```json
{
  "code": 200,
  "message": "验证码已发送",
  "data": null
}
```

---

### 2.5 忘记密码

**接口名称**：重置密码

**请求方法**：POST

**URL路径**：`/auth/reset-password`

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|-------|------|------|------|
| phone | String | 是 | 手机号 |
| code | String | 是 | 验证码 |
| newPassword | String | 是 | 新密码（6-20个字符） |

**请求示例**：
```json
{
  "phone": "13800138000",
  "code": "123456",
  "newPassword": "123456"
}
```

**响应示例**：
```json
{
  "code": 200,
  "message": "密码重置成功",
  "data": null
}
```

---

### 2.6 第三方登录

**接口名称**：第三方登录

**请求方法**：POST

**URL路径**：`/auth/social-login`

**请求参数**：

| 参数名 | 类型 | 必填 | 说明 |
|-------|------|------|------|
| provider | String | 是 | 第三方平台（wechat/qq/weibo） |
| code | String | 是 | 授权码 |

**请求示例**：
```json
{
  "provider": "wechat",
  "code": "auth_code_123"
}
```

**响应数据结构**：

| 字段名 | 类型 | 说明 |
|-------|------|------|
| token | String | 访问令牌 |
| user | Object | 用户信息 |
| isNewUser | Boolean | 是否新用户 |

**响应示例**：
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "张三",
      "avatar": "https://example.com/avatar.jpg",
      "level": "普通会员",
      "points": 0
    },
    "isNewUser": false
  }
}
```

---

### 2.7 用户登出

**接口名称**：用户登出

**请求方法**：POST

**URL路径**：`/auth/logout`

**请求头**：
- `Authorization: Bearer {token}`

**响应示例**：
```json
{
  "code": 200,
  "message": "登出成功",
  "data": null
}
```

---

### 2.8 获取用户信息

**接口名称**：获取当前用户信息

**请求方法**：GET

**URL路径**：`/user/profile`

**请求头**：
- `Authorization: Bearer {token}`

**响应数据结构**：

| 字段名 | 类型 | 说明 |
|-------|------|------|
| id | Number | 用户ID |
| username | String | 用户名 |
| phone | String | 手机号 |
| email | String | 邮箱 |
| avatar | String | 头像URL |
| level | String | 会员等级 |
| points | Number | 积分 |
| isSeller | Boolean | 是否卖家 |
| sellerInfo | Object | 卖家信息 |
| createdAt | String | 创建时间 |

**响应示例**：
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "username": "张三",
    "phone": "13800138000",
    "email": "zhangsan@example.com",
    "avatar": "https://example.com/avatar.jpg",
    "level": "普通会员",
    "points": 2580,
    "isSeller": false,
    "sellerInfo": null,
    "createdAt": "2024-01-15T10:00:00Z"
  }
}
```
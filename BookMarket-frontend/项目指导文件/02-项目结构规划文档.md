# 书市项目结构规划文档

## 1. 项目概述

### 1.1 技术栈
- **前端框架**：Vue 3 (Composition API + `<script setup>`)
- **UI框架**：Tailwind CSS
- **状态管理**：Pinia
- **路由管理**：Vue Router 4
- **HTTP客户端**：Axios
- **构建工具**：Vite
- **代码规范**：ESLint + Prettier
- **类型检查**：TypeScript

### 1.2 项目目录结构

```
BookMarket-frontend/
├── public/                          # 静态资源
│   ├── favicon.ico
│   └── images/                      # 公共图片
├── src/                             # 源代码目录
│   ├── assets/                      # 资源文件
│   │   ├── images/                  # 图片资源
│   │   │   ├── logo.png
│   │   │   ├── default-avatar.png
│   │   │   └── placeholders/
│   │   ├── icons/                   # 图标资源
│   │   │   └── svg/
│   │   └── styles/                  # 全局样式
│   │       ├── index.css            # 主样式文件
│   │       ├── variables.css        # CSS变量
│   │       └── tailwind.css         # Tailwind配置
│   ├── components/                  # 组件目录
│   │   ├── common/                  # 通用组件
│   │   │   ├── AppHeader.vue        # 顶部导航栏
│   │   │   ├── AppFooter.vue        # 页脚
│   │   │   ├── AppBreadcrumb.vue    # 面包屑导航
│   │   │   ├── AppSearch.vue        # 搜索框
│   │   │   ├── AppButton.vue        # 按钮组件
│   │   │   ├── AppInput.vue         # 输入框组件
│   │   │   ├── AppSelect.vue        # 下拉框组件
│   │   │   ├── AppCheckbox.vue      # 复选框组件
│   │   │   ├── AppRadio.vue         # 单选框组件
│   │   │   ├── AppModal.vue         # 模态框组件
│   │   │   ├── AppToast.vue         # 提示框组件
│   │   │   ├── AppPagination.vue    # 分页组件
│   │   │   ├── AppLoading.vue       # 加载组件
│   │   │   └── AppEmpty.vue         # 空状态组件
│   │   ├── book/                    # 书籍相关组件
│   │   │   ├── BookCard.vue         # 书籍卡片
│   │   │   ├── BookList.vue         # 书籍列表
│   │   │   ├── BookDetail.vue       # 书籍详情
│   │   │   ├── BookGallery.vue      # 书籍图片展示
│   │   │   ├── BookInfo.vue         # 书籍信息
│   │   │   ├── BookSeller.vue       # 卖家信息
│   │   │   └── BookReviews.vue      # 书籍评价
│   │   ├── category/                # 分类相关组件
│   │   │   ├── CategoryCard.vue     # 分类卡片
│   │   │   ├── CategoryList.vue     # 分类列表
│   │   │   └── CategoryFilter.vue   # 分类筛选器
│   │   ├── cart/                    # 购物车相关组件
│   │   │   ├── CartItem.vue         # 购物车商品项
│   │   │   ├── CartList.vue         # 购物车列表
│   │   │   ├── CartSummary.vue      # 购物车汇总
│   │   │   └── QuantitySelector.vue # 数量选择器
│   │   ├── order/                   # 订单相关组件
│   │   │   ├── OrderCard.vue        # 订单卡片
│   │   │   ├── OrderList.vue        # 订单列表
│   │   │   ├── OrderStatus.vue      # 订单状态
│   │   │   └── OrderTabs.vue        # 订单Tab
│   │   ├── user/                    # 用户相关组件
│   │   │   ├── UserAvatar.vue       # 用户头像
│   │   │   ├── UserCard.vue         # 用户卡片
│   │   │   ├── UserStats.vue        # 用户统计
│   │   │   └── UserSidebar.vue      # 用户侧边栏
│   │   ├── seller/                  # 卖家相关组件
│   │   │   ├── SellerCard.vue       # 卖家卡片
│   │   │   ├── SellerStats.vue      # 卖家统计
│   │   │   ├── SellerSidebar.vue    # 卖家侧边栏
│   │   │   └── BookForm.vue         # 书籍发布表单
│   │   ├── auth/                    # 认证相关组件
│   │   │   ├── LoginForm.vue        # 登录表单
│   │   │   ├── RegisterForm.vue     # 注册表单
│   │   │   ├── SocialLogin.vue      # 第三方登录
│   │   │   └── ForgotPassword.vue   # 忘记密码
│   │   ├── review/                  # 评价相关组件
│   │   │   ├── ReviewCard.vue       # 评价卡片
│   │   │   ├── ReviewList.vue       # 评价列表
│   │   │   ├── ReviewStats.vue      # 评价统计
│   │   │   └── RatingStars.vue      # 星级评分
│   │   ├── upload/                  # 上传相关组件
│   │   │   ├── ImageUpload.vue      # 图片上传
│   │   │   ├── ImagePreview.vue     # 图片预览
│   │   │   └── FileUpload.vue       # 文件上传
│   │   └── feature/                 # 特色组件
│   │       ├── FeatureCard.vue      # 特色卡片
│   │       └── FeatureList.vue      # 特色列表
│   ├── composables/                 # 组合式函数
│   │   ├── useAuth.js               # 认证相关
│   │   ├── useCart.js               # 购物车相关
│   │   ├── useBook.js               # 书籍相关
│   │   ├── useOrder.js              # 订单相关
│   │   ├── useUser.js               # 用户相关
│   │   ├── useSeller.js             # 卖家相关
│   │   ├── useFavorite.js           # 收藏相关
│   │   ├── useSearch.js             # 搜索相关
│   │   ├── usePagination.js         # 分页相关
│   │   ├── useUpload.js             # 上传相关
│   │   ├── useToast.js              # 提示相关
│   │   ├── useModal.js              # 模态框相关
│   │   └── useDebounce.js           # 防抖相关
│   ├── views/                       # 页面组件
│   │   ├── Home.vue                 # 首页
│   │   ├── Books.vue                # 书籍列表页
│   │   ├── BookDetail.vue           # 书籍详情页
│   │   ├── Cart.vue                 # 购物车页
│   │   ├── Login.vue                # 登录页
│   │   ├── Register.vue             # 注册页
│   │   ├── UserCenter.vue           # 用户中心
│   │   ├── UserOrders.vue           # 用户订单
│   │   ├── UserFavorites.vue        # 用户收藏
│   │   ├── UserAddress.vue          # 收货地址
│   │   ├── UserSecurity.vue        # 账户安全
│   │   ├── UserSettings.vue         # 用户设置
│   │   ├── SellerCenter.vue         # 卖家中心
│   │   ├── SellerPublish.vue        # 发布书籍
│   │   ├── SellerBooks.vue          # 在售书籍
│   │   ├── SellerOrders.vue         # 卖家订单
│   │   ├── SellerRevenue.vue        # 收益管理
│   │   └── SellerSettings.vue       # 店铺设置
│   ├── router/                      # 路由配置
│   │   ├── index.js                 # 路由主文件
│   │   ├── routes.js                # 路由定义
│   │   └── guards.js                # 路由守卫
│   ├── store/                       # 状态管理
│   │   ├── index.js                 # Store主文件
│   │   ├── modules/                 # Store模块
│   │   │   ├── auth.js              # 认证模块
│   │   │   ├── user.js              # 用户模块
│   │   │   ├── book.js              # 书籍模块
│   │   │   ├── cart.js              # 购物车模块
│   │   │   ├── order.js             # 订单模块
│   │   │   ├── seller.js            # 卖家模块
│   │   │   ├── favorite.js          # 收藏模块
│   │   │   ├── search.js            # 搜索模块
│   │   │   └── app.js               # 应用模块
│   ├── api/                         # API接口
│   │   ├── index.js                 # API主文件
│   │   ├── request.js               # 请求封装
│   │   ├── auth.js                  # 认证接口
│   │   ├── user.js                  # 用户接口
│   │   ├── book.js                  # 书籍接口
│   │   ├── cart.js                  # 购物车接口
│   │   ├── order.js                 # 订单接口
│   │   ├── seller.js                # 卖家接口
│   │   ├── favorite.js              # 收藏接口
│   │   ├── review.js                # 评价接口
│   │   ├── upload.js                # 上传接口
│   │   └── search.js                # 搜索接口
│   ├── utils/                       # 工具函数
│   │   ├── format.js                # 格式化函数
│   │   ├── validate.js              # 验证函数
│   │   ├── storage.js               # 存储函数
│   │   ├── date.js                  # 日期函数
│   │   ├── string.js                # 字符串函数
│   │   ├── number.js                # 数字函数
│   │   ├── image.js                 # 图片函数
│   │   └── constants.js             # 常量定义
│   ├── types/                       # TypeScript类型定义
│   │   ├── index.ts                 # 类型主文件
│   │   ├── user.ts                  # 用户类型
│   │   ├── book.ts                  # 书籍类型
│   │   ├── cart.ts                  # 购物车类型
│   │   ├── order.ts                 # 订单类型
│   │   ├── seller.ts                # 卖家类型
│   │   ├── favorite.ts              # 收藏类型
│   │   ├── review.ts                # 评价类型
│   │   └── api.ts                   # API类型
│   ├── directives/                  # 自定义指令
│   │   ├── lazyLoad.js              # 图片懒加载
│   │   ├── clickOutside.js          # 点击外部
│   │   └── infiniteScroll.js        # 无限滚动
│   ├── plugins/                     # 插件
│   │   ├── dayjs.js                 # Day.js插件
│   │   └── vue-lazyload.js          # 懒加载插件
│   ├── config/                      # 配置文件
│   │   ├── index.js                 # 配置主文件
│   │   ├── env.js                   # 环境配置
│   │   └── constants.js             # 常量配置
│   ├── App.vue                      # 根组件
│   └── main.js                      # 入口文件
├── .env                             # 环境变量
├── .env.development                 # 开发环境变量
├── .env.production                  # 生产环境变量
├── .eslintrc.js                     # ESLint配置
├── .prettierrc.js                   # Prettier配置
├── .gitignore                       # Git忽略文件
├── index.html                       # HTML模板
├── package.json                     # 项目配置
├── tsconfig.json                    # TypeScript配置
├── vite.config.js                   # Vite配置
├── tailwind.config.js               # Tailwind配置
├── postcss.config.js                # PostCSS配置
└── README.md                        # 项目说明
```

---

## 2. 组件划分

### 2.1 页面级组件 (Views)
位于 `src/views/` 目录，对应路由页面

| 组件名称 | 文件路径 | 功能描述 |
|---------|---------|---------|
| Home | Home.vue | 首页，展示Hero、分类、推荐、特色 |
| Books | Books.vue | 书籍列表页，支持筛选和排序 |
| BookDetail | BookDetail.vue | 书籍详情页，展示书籍信息和评价 |
| Cart | Cart.vue | 购物车页，管理已选商品 |
| Login | Login.vue | 登录页，支持多种登录方式 |
| Register | Register.vue | 注册页，支持手机号注册 |
| UserCenter | UserCenter.vue | 用户中心首页 |
| UserOrders | UserOrders.vue | 用户订单列表 |
| UserFavorites | UserFavorites.vue | 用户收藏列表 |
| UserAddress | UserAddress.vue | 收货地址管理 |
| UserSecurity | UserSecurity.vue | 账户安全设置 |
| UserSettings | UserSettings.vue | 用户设置 |
| SellerCenter | SellerCenter.vue | 卖家中心首页 |
| SellerPublish | SellerPublish.vue | 发布书籍页 |
| SellerBooks | SellerBooks.vue | 在售书籍管理 |
| SellerOrders | SellerOrders.vue | 卖家订单管理 |
| SellerRevenue | SellerRevenue.vue | 收益管理 |
| SellerSettings | SellerSettings.vue | 店铺设置 |

### 2.2 业务组件 (Business Components)
位于 `src/components/` 下的业务相关目录

#### 书籍组件 (book/)
| 组件名称 | 功能描述 |
|---------|---------|
| BookCard | 书籍卡片，展示封面、信息、价格 |
| BookList | 书籍列表，网格或列表布局 |
| BookDetail | 书籍详情主组件 |
| BookGallery | 书籍图片展示，支持缩略图切换 |
| BookInfo | 书籍基本信息展示 |
| BookSeller | 卖家信息展示 |
| BookReviews | 书籍评价列表 |

#### 购物车组件 (cart/)
| 组件名称 | 功能描述 |
|---------|---------|
| CartItem | 购物车商品项 |
| CartList | 购物车列表 |
| CartSummary | 购物车汇总信息 |
| QuantitySelector | 数量选择器 |

#### 订单组件 (order/)
| 组件名称 | 功能描述 |
|---------|---------|
| OrderCard | 订单卡片 |
| OrderList | 订单列表 |
| OrderStatus | 订单状态展示 |
| OrderTabs | 订单Tab切换 |

#### 用户组件 (user/)
| 组件名称 | 功能描述 |
|---------|---------|
| UserAvatar | 用户头像 |
| UserCard | 用户信息卡片 |
| UserStats | 用户统计数据 |
| UserSidebar | 用户侧边栏导航 |

#### 卖家组件 (seller/)
| 组件名称 | 功能描述 |
|---------|---------|
| SellerCard | 卖家信息卡片 |
| SellerStats | 卖家统计数据 |
| SellerSidebar | 卖家侧边栏导航 |
| BookForm | 书籍发布表单 |

#### 认证组件 (auth/)
| 组件名称 | 功能描述 |
|---------|---------|
| LoginForm | 登录表单 |
| RegisterForm | 注册表单 |
| SocialLogin | 第三方登录 |
| ForgotPassword | 忘记密码 |

#### 评价组件 (review/)
| 组件名称 | 功能描述 |
|---------|---------|
| ReviewCard | 评价卡片 |
| ReviewList | 评价列表 |
| ReviewStats | 评价统计 |
| RatingStars | 星级评分 |

#### 上传组件 (upload/)
| 组件名称 | 功能描述 |
|---------|---------|
| ImageUpload | 图片上传 |
| ImagePreview | 图片预览 |
| FileUpload | 文件上传 |

### 2.3 通用组件 (Common Components)
位于 `src/components/common/` 目录

| 组件名称 | 功能描述 |
|---------|---------|
| AppHeader | 顶部导航栏 |
| AppFooter | 页脚 |
| AppBreadcrumb | 面包屑导航 |
| AppSearch | 搜索框 |
| AppButton | 按钮组件 |
| AppInput | 输入框组件 |
| AppSelect | 下拉框组件 |
| AppCheckbox | 复选框组件 |
| AppRadio | 单选框组件 |
| AppModal | 模态框组件 |
| AppToast | 提示框组件 |
| AppPagination | 分页组件 |
| AppLoading | 加载组件 |
| AppEmpty | 空状态组件 |

---

## 3. 路由设计

### 3.1 路由配置

```javascript
// src/router/routes.js
const routes = [
  {
    path: '/',
    name: 'Home',
    component: () => import('@/views/Home.vue'),
    meta: { title: '首页' }
  },
  {
    path: '/books',
    name: 'Books',
    component: () => import('@/views/Books.vue'),
    meta: { title: '全部书籍' }
  },
  {
    path: '/books/:id',
    name: 'BookDetail',
    component: () => import('@/views/BookDetail.vue'),
    meta: { title: '书籍详情' }
  },
  {
    path: '/cart',
    name: 'Cart',
    component: () => import('@/views/Cart.vue'),
    meta: { title: '购物车', requiresAuth: true }
  },
  {
    path: '/login',
    name: 'Login',
    component: () => import('@/views/Login.vue'),
    meta: { title: '登录', guest: true }
  },
  {
    path: '/register',
    name: 'Register',
    component: () => import('@/views/Register.vue'),
    meta: { title: '注册', guest: true }
  },
  {
    path: '/user',
    name: 'UserCenter',
    component: () => import('@/views/UserCenter.vue'),
    meta: { title: '用户中心', requiresAuth: true },
    redirect: '/user/orders',
    children: [
      {
        path: 'orders',
        name: 'UserOrders',
        component: () => import('@/views/UserOrders.vue'),
        meta: { title: '我的订单' }
      },
      {
        path: 'favorites',
        name: 'UserFavorites',
        component: () => import('@/views/UserFavorites.vue'),
        meta: { title: '我的收藏' }
      },
      {
        path: 'address',
        name: 'UserAddress',
        component: () => import('@/views/UserAddress.vue'),
        meta: { title: '收货地址' }
      },
      {
        path: 'security',
        name: 'UserSecurity',
        component: () => import('@/views/UserSecurity.vue'),
        meta: { title: '账户安全' }
      },
      {
        path: 'settings',
        name: 'UserSettings',
        component: () => import('@/views/UserSettings.vue'),
        meta: { title: '设置' }
      }
    ]
  },
  {
    path: '/seller',
    name: 'SellerCenter',
    component: () => import('@/views/SellerCenter.vue'),
    meta: { title: '卖家中心', requiresAuth: true, requiresSeller: true },
    redirect: '/seller/publish',
    children: [
      {
        path: 'publish',
        name: 'SellerPublish',
        component: () => import('@/views/SellerPublish.vue'),
        meta: { title: '发布书籍' }
      },
      {
        path: 'books',
        name: 'SellerBooks',
        component: () => import('@/views/SellerBooks.vue'),
        meta: { title: '在售书籍' }
      },
      {
        path: 'orders',
        name: 'SellerOrders',
        component: () => import('@/views/SellerOrders.vue'),
        meta: { title: '订单管理' }
      },
      {
        path: 'revenue',
        name: 'SellerRevenue',
        component: () => import('@/views/SellerRevenue.vue'),
        meta: { title: '收益管理' }
      },
      {
        path: 'settings',
        name: 'SellerSettings',
        component: () => import('@/views/SellerSettings.vue'),
        meta: { title: '店铺设置' }
      }
    ]
  },
  {
    path: '/:pathMatch(.*)*',
    name: 'NotFound',
    component: () => import('@/views/NotFound.vue'),
    meta: { title: '页面不存在' }
  }
]
```

### 3.2 路由守卫

```javascript
// src/router/guards.js
import { useAuthStore } from '@/store/modules/auth'

export function setupRouterGuards(router) {
  // 全局前置守卫
  router.beforeEach((to, from, next) => {
    const authStore = useAuthStore()
    const isAuthenticated = authStore.isAuthenticated
    const isSeller = authStore.isSeller

    // 设置页面标题
    document.title = to.meta.title ? `${to.meta.title} - 书市` : '书市'

    // 需要登录的页面
    if (to.meta.requiresAuth && !isAuthenticated) {
      next({
        path: '/login',
        query: { redirect: to.fullPath }
      })
      return
    }

    // 需要卖家权限的页面
    if (to.meta.requiresSeller && !isSeller) {
      next({
        path: '/user'
      })
      return
    }

    // 已登录用户不能访问登录/注册页
    if (to.meta.guest && isAuthenticated) {
      next({ path: '/' })
      return
    }

    next()
  })

  // 全局后置钩子
  router.afterEach((to, from) => {
    // 页面滚动到顶部
    window.scrollTo(0, 0)
  })
}
```

### 3.3 动态路由
根据用户权限动态添加路由（可选）

```javascript
// 根据用户角色动态加载路由
export function getDynamicRoutes(userRole) {
  const routes = []
  
  if (userRole === 'seller') {
    routes.push({
      path: '/seller',
      component: () => import('@/views/SellerCenter.vue'),
      children: [
        // 卖家相关路由
      ]
    })
  }
  
  return routes
}
```

---

## 4. 状态管理方案

### 4.1 Pinia Store模块划分

#### 4.1.1 认证模块 (auth.js)
```javascript
// src/store/modules/auth.js
export const useAuthStore = defineStore('auth', {
  state: () => ({
    token: localStorage.getItem('token') || null,
    user: null,
    isAuthenticated: false,
    isSeller: false
  }),
  getters: {
    userInfo: (state) => state.user,
    hasToken: (state) => !!state.token
  },
  actions: {
    async login(credentials) {
      // 登录逻辑
    },
    async register(data) {
      // 注册逻辑
    },
    async logout() {
      // 登出逻辑
    },
    async fetchUserInfo() {
      // 获取用户信息
    }
  }
})
```

#### 4.1.2 用户模块 (user.js)
```javascript
// src/store/modules/user.js
export const useUserStore = defineStore('user', {
  state: () => ({
    profile: null,
    addresses: [],
    stats: null
  }),
  getters: {
    defaultAddress: (state) => {
      return state.addresses.find(addr => addr.isDefault) || null
    }
  },
  actions: {
    async fetchProfile() {
      // 获取用户资料
    },
    async updateProfile(data) {
      // 更新用户资料
    },
    async fetchAddresses() {
      // 获取收货地址
    },
    async addAddress(data) {
      // 添加收货地址
    },
    async updateAddress(id, data) {
      // 更新收货地址
    },
    async deleteAddress(id) {
      // 删除收货地址
    },
    async fetchStats() {
      // 获取用户统计
    }
  }
})
```

#### 4.1.3 书籍模块 (book.js)
```javascript
// src/store/modules/book.js
export const useBookStore = defineStore('book', {
  state: () => ({
    books: [],
    currentBook: null,
    categories: [],
    filters: {
      category: null,
      priceRange: null,
      condition: null
    },
    pagination: {
      page: 1,
      pageSize: 12,
      total: 0
    }
  }),
  getters: {
    filteredBooks: (state) => {
      // 根据筛选条件过滤书籍
    }
  },
  actions: {
    async fetchBooks(params) {
      // 获取书籍列表
    },
    async fetchBookDetail(id) {
      // 获取书籍详情
    },
    async fetchCategories() {
      // 获取分类列表
    },
    async searchBooks(keyword) {
      // 搜索书籍
    },
    setFilters(filters) {
      // 设置筛选条件
    },
    resetFilters() {
      // 重置筛选条件
    }
  }
})
```

#### 4.1.4 购物车模块 (cart.js)
```javascript
// src/store/modules/cart.js
export const useCartStore = defineStore('cart', {
  state: () => ({
    items: [],
    selectedItems: []
  }),
  getters: {
    totalItems: (state) => state.items.length,
    selectedTotal: (state) => {
      return state.selectedItems.reduce((sum, item) => sum + item.price * item.quantity, 0)
    },
    selectedCount: (state) => state.selectedItems.length
  },
  actions: {
    async fetchCart() {
      // 获取购物车
    },
    async addToCart(bookId, quantity) {
      // 添加到购物车
    },
    async updateCartItem(id, quantity) {
      // 更新购物车商品
    },
    async removeFromCart(id) {
      // 从购物车删除
    },
    async clearCart() {
      // 清空购物车
    },
    toggleSelectItem(item) {
      // 切换商品选中状态
    },
    toggleSelectAll() {
      // 切换全选
    }
  }
})
```

#### 4.1.5 订单模块 (order.js)
```javascript
// src/store/modules/order.js
export const useOrderStore = defineStore('order', {
  state: () => ({
    orders: [],
    currentOrder: null,
    orderStats: null
  }),
  getters: {
    pendingOrders: (state) => {
      return state.orders.filter(order => order.status === 'pending')
    }
  },
  actions: {
    async fetchOrders(params) {
      // 获取订单列表
    },
    async fetchOrderDetail(id) {
      // 获取订单详情
    },
    async createOrder(data) {
      // 创建订单
    },
    async cancelOrder(id) {
      // 取消订单
    },
    async payOrder(id) {
      // 支付订单
    },
    async confirmReceipt(id) {
      // 确认收货
    },
    async fetchOrderStats() {
      // 获取订单统计
    }
  }
})
```

#### 4.1.6 卖家模块 (seller.js)
```javascript
// src/store/modules/seller.js
export const useSellerStore = defineStore('seller', {
  state: () => ({
    sellerInfo: null,
    sellerBooks: [],
    sellerOrders: [],
    revenue: null
  }),
  getters: {
    totalRevenue: (state) => {
      return state.revenue?.total || 0
    }
  },
  actions: {
    async fetchSellerInfo() {
      // 获取卖家信息
    },
    async fetchSellerBooks(params) {
      // 获取在售书籍
    },
    async publishBook(data) {
      // 发布书籍
    },
    async updateBook(id, data) {
      // 更新书籍
    },
    async deleteBook(id) {
      // 删除书籍
    },
    async fetchSellerOrders(params) {
      // 获取卖家订单
    },
    async shipOrder(id) {
      // 发货
    },
    async fetchRevenue(params) {
      // 获取收益
    }
  }
})
```

#### 4.1.7 收藏模块 (favorite.js)
```javascript
// src/store/modules/favorite.js
export const useFavoriteStore = defineStore('favorite', {
  state: () => ({
    favorites: []
  }),
  getters: {
    isFavorite: (state) => (bookId) => {
      return state.favorites.some(fav => fav.bookId === bookId)
    }
  },
  actions: {
    async fetchFavorites() {
      // 获取收藏列表
    },
    async addFavorite(bookId) {
      // 添加收藏
    },
    async removeFavorite(bookId) {
      // 取消收藏
    }
  }
})
```

#### 4.1.8 搜索模块 (search.js)
```javascript
// src/store/modules/search.js
export const useSearchStore = defineStore('search', {
  state: () => ({
    history: [],
    hotKeywords: [],
    suggestions: []
  }),
  actions: {
    async fetchHotKeywords() {
      // 获取热门搜索
    },
    async fetchSuggestions(keyword) {
      // 获取搜索建议
    },
    addToHistory(keyword) {
      // 添加到搜索历史
    },
    clearHistory() {
      // 清空搜索历史
    },
    removeFromHistory(keyword) {
      // 删除搜索历史
    }
  }
})
```

#### 4.1.9 应用模块 (app.js)
```javascript
// src/store/modules/app.js
export const useAppStore = defineStore('app', {
  state: () => ({
    loading: false,
    toast: null,
    modal: null
  }),
  actions: {
    setLoading(loading) {
      // 设置加载状态
    },
    showToast(toast) {
      // 显示提示
    },
    hideToast() {
      // 隐藏提示
    },
    showModal(modal) {
      // 显示模态框
    },
    hideModal() {
      // 隐藏模态框
    }
  }
})
```

### 4.2 数据流向

```
用户操作 → 组件 → Composable → Store → API → 后端
                    ↓
                响应式更新
                    ↓
                组件重新渲染
```

### 4.3 状态持久化

```javascript
// 使用 pinia-plugin-persistedstate 插件
import { createPinia } from 'pinia'
import piniaPluginPersistedstate from 'pinia-plugin-persistedstate'

const pinia = createPinia()
pinia.use(piniaPluginPersistedstate)

// 在 store 中配置持久化
export const useAuthStore = defineStore('auth', {
  persist: {
    enabled: true,
    strategies: [
      {
        key: 'auth',
        storage: localStorage,
        paths: ['token', 'user']
      }
    ]
  }
})
```

---

## 5. 目录组织原则

### 5.1 按功能模块组织
- 将相关功能的组件、API、Store放在同一目录下
- 便于查找和维护

### 5.2 按类型组织
- components：按业务类型分组
- views：按页面分组
- composables：按功能分组
- store：按模块分组

### 5.3 命名规范
- 组件：PascalCase（如 BookCard.vue）
- 文件：kebab-case（如 book-detail.vue）
- 变量/函数：camelCase（如 fetchBooks）
- 常量：UPPER_SNAKE_CASE（如 API_BASE_URL）

### 5.4 导入顺序
```javascript
// 1. Vue相关
import { ref, computed } from 'vue'
import { useRouter } from 'vue-router'

// 2. 第三方库
import axios from 'axios'
import dayjs from 'dayjs'

// 3. 组件
import BookCard from '@/components/book/BookCard.vue'

// 4. Store
import { useAuthStore } from '@/store/modules/auth'

// 5. API
import { fetchBooks } from '@/api/book'

// 6. Utils
import { formatPrice } from '@/utils/format'

// 7. Types
import type { Book } from '@/types/book'
```

---

## 6. 总结

本文档详细定义了书市Vue3项目的目录结构、组件划分、路由设计和状态管理方案。开发团队应严格按照本文档进行项目组织，确保代码结构清晰、可维护性强、易于扩展。
